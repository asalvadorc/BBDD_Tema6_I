<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><link rel="canonical" href="https://asalvadorc.github.io/BBDD_POSTGRESQL/BD_PostgreSQL_DQL/5_funcions_dagregat/" />
      <link rel="shortcut icon" href="../../img/favicon.ico" />
    <title>5. Funcions d'agregat - BD - Bases de Dades</title>
    <link rel="stylesheet" href="../../css/theme.css" />
    <link rel="stylesheet" href="../../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
        <link href="../../css/extra.css" rel="stylesheet" />
        <link href="../../img/favicon.ico" rel="stylesheet" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "5. Funcions d\u0027agregat";
        var mkdocs_page_input_path = "BD_PostgreSQL_DQL/5_funcions_dagregat.md";
        var mkdocs_page_url = "/BBDD_POSTGRESQL/BD_PostgreSQL_DQL/5_funcions_dagregat/";
      </script>
    
    <!--[if lt IE 9]>
      <script src="../../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
      <script>hljs.highlightAll();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href="../..">
          <img src="../../assets/logocaminas.png" class="logo" alt="Logo"/>
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption"><span class="caption-text">SQL - POSTGRES</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../objectius_i_coneixements_previs/">Objectius i Coneixements previs</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../1_introducci/">1. Introducció</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../2_client_dbeaver_installaci_i_confiuraci/">2. DBeaver</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../3_dades_dels_exemples_i_els_exercicis/">3 Dades dels exemples i els exercicis</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" >4. Operadors i Funcions de Postgres</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../6_operadors/">4.1. Operadors</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../7_funcions/">4.2. Funcions</a>
                </li>
    </ul>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">DQL Consultes (part I)</span></p>
              <ul class="current">
                  <li class="toctree-l1"><a class="reference internal" href="../1_la_consulta_select/">1. La consulta SELECT</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../2_consulta_bsica/">2. Consulta bàsica</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../3_lies_en_les_columnes/">3. Àlies en les columnes</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../4_la_clusula_where/">4. La clàusula WHERE</a>
                  </li>
                  <li class="toctree-l1 current"><a class="reference internal current" href="#">5. Funcions d'agregat</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#exercicis">Exercicis</a>
    </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../6_la_clusula_group_by/">6. La clàusula GROUP BY</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../7_la_clusula_having/">7. La clàusula HAVING</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../8_la_clusula_order_by/">8. La clàusula ORDER BY</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../9_el_predicat_distinct/">9. El predicat DISTINCT</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../10_la_clusula_limit__offset/">10. La clàusula LIMIT .. OFFSET</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../11_consulta_de_creaci_de_taules/">11. Consulta de creació de taules</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../12_ordre_amb_qu_sexecuta_una_sentncia_sql/">12. Ordre amb que s'executa una sentència SQL</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../exercicis_de_tot_el_tema_amb_els_resultats/">Exercicis amb els resultats (part I)</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">DQL Consultes avançades (part II)</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../BD_PostgreSQL_DQL_Avancat/21_introducci/">1. Introducció</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../BD_PostgreSQL_DQL_Avancat/22_combinacions_de_taules/">2. Combinacions de taules</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../BD_PostgreSQL_DQL_Avancat/23_subconsultes/">3. Subconsultes</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../BD_PostgreSQL_DQL_Avancat/24_consultes_doperacions_de_conjunts/">4. Consultes d'operacions de conjunts</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../BD_PostgreSQL_DQL_Avancat/exercicis_de_tot_el_tema_amb_els_resultats/">Exercicis amb els resultats (part II)</a>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../..">BD - Bases de Dades</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../.." class="icon icon-home" aria-label="Docs"></a></li>
          <li class="breadcrumb-item">DQL Consultes (part I)</li>
      <li class="breadcrumb-item active">5. Funcions d'agregat</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="5-funcions-dagregat">5. Funcions d'agregat</h1>
<p>Les <strong>funcions d'agregat</strong>, o funcions de domini agregat, són aquelles que
trauen un resultat a partir dels valors d'un determinat camp en un conjunt de
files. Així tindrem una funció per a <strong>sumar</strong> els valors d'una columna, o
<strong>comptar</strong> -los, o traure la <strong>mitjana</strong> , o el <strong>màxim</strong> , ...</p>
<p>Actuaran sobre un conjunt de files determinat, que en principi suposarem que
és tota la taula (totes les files de la taula). En la següent pregunta, veurem
que el conjunt de files sobre el qual es calcula una funció d'agregat, el
podrem canviar amb la clàusula <strong>GROUP BY</strong>.</p>
<p><strong><u>Sintaxi</u></strong></p>
<ul>
<li>
<p><em><em>COUNT (</em> | <expressió> ) *</em>: compta el número de files; si es posa una columna o expressió, no es comptaran els valors nuls.</p>
</li>
<li>
<p>*<em>SUM ( <expressió> ) *</em>: torna la suma de la columna o expressió especificada. Ignora els valors nuls.</p>
</li>
<li>
<p>*<em>AVG ( <expressió> ) *</em>: calcula la mitjana aritmètica de la columna o expressió especificada. Ignora els valors nuls.</p>
</li>
<li>
<p>*<em>VAR_SAMP ( <expressió> ) *</em>: calcula la variància d'una mostra a partir de la columna o expressió especificada.</p>
</li>
<li>
<p>*<em>STDDEV ( <expressió> ) *</em>: desviació típica d'una mostra.</p>
</li>
<li>
<p>*<em>MAX ( <expressió> ) *</em>: calcula el màxim.</p>
</li>
<li>
<p>*<em>MIN ( <expressió> ) *</em>: calcula el mínim.</p>
</li>
</ul>
<p>Per exemple, si volem saber el nombre d'Instituts:
<div class="highlight"><pre><span></span><code>SELECT COUNT(*) AS &quot;Nombre d&#39;Instituts&quot;  
   FROM INSTITUTS;
</code></pre></div></p>
<div class="admonition note">
<p class="admonition-title">Nota</p>
<p>És interessant la utilització d'àlias, per a que no apareguen capçaleres com <em><strong>count</strong></em></p>
</div>
<p><strong><u>Exemples</u></strong></p>
<p>1) Comptar el nombre total de pobles.
<div class="highlight"><pre><span></span><code>SELECT Count(*)  
  FROM POBLACIONS;
</code></pre></div>
  2) Comptar el nombre de poblacions de la <strong>Plana Alta</strong>.
<div class="highlight"><pre><span></span><code>SELECT Count(*)  
  FROM POBLACIONS  
  WHERE nom_c = &#39;Plana Alta&#39;;
</code></pre></div>
  3) Calcular la mitjana d'habitants dels pobles de la <strong>Plana Alta</strong> i <strong>Plana Baixa</strong>.
<div class="highlight"><pre><span></span><code>SELECT AVG(poblacio)  
  FROM POBLACIONS  
  WHERE nom_c = &#39;Plana Alta&#39; OR nom_c = &#39;Plana Baixa&#39;
</code></pre></div>
  4) Calcular la mitjana de densitat de les poblacions. La densitat es calcula com el número d'habitants dividit per l'extensió.
<div class="highlight"><pre><span></span><code>SELECT AVG(poblacio/extensio)  
  FROM POBLACIONS;
</code></pre></div>
  5) Calcular l'altura màxima i mínima de tots els pobles.
<div class="highlight"><pre><span></span><code>SELECT MAX(altura), MIN(altura)  
  FROM POBLACIONS
</code></pre></div></p>
<h2 id="exercicis"><img alt="✏️" class="emojione" src="https://cdnjs.cloudflare.com/ajax/libs/emojione/2.2.7/assets/png/270f.png" title=":pencil2:" /> Exercicis</h2>
<p><strong>Ex_15</strong> Comptar el nombre de <strong>clients</strong> que tenen el <strong>codi postal nul</strong>.</p>
<p><strong>Ex_16</strong> Comptar el número de vegades que l'article <strong>L76104</strong> entra en les
línies de factura, i el número total d'unitats venudes d'aquest article. Només
us fa falta la taula LINIA_FAC.</p>
<p><strong>Ex_17</strong> Traure la <strong>mitjana</strong> del <strong>stock</strong> dels articles.</p>
<p><strong>Ex_18</strong> Modificar l'anterior per a<strong>tenir en compte els valors nuls, com si
foren 0</strong>. Us vindrà bé la funció <strong>COALESCE</strong> que converteix els nuls del
primer paràmetre al valor donat com a segon paràmetre (si és diferent de nul,
deixa igual el valor). Per tant l'heu d'utilitzar d'aquesta manera:
<strong>COALESCE(stock,0)</strong></p>
<p><strong>Ex_19</strong> Comptar <strong>quantes factures</strong> té el client <strong>375</strong>  </p>
<p><strong>Ex_20</strong> Calcular el <strong>descompte màxim</strong> , el <strong>mínim</strong> i el descompte
<strong>mitjà</strong> de les <strong>factures</strong>.</p>
<p>Llicenciat sota la  <a href="http://creativecommons.org/licenses/by-nc-sa/3.0/">Llicència Creative Commons Reconeixement NoComercial
CompartirIgual 3.0</a></p>
              
            </div>
          </div><footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="Footer Navigation">
        <a href="../4_la_clusula_where/" class="btn btn-neutral float-left" title="4. La clàusula WHERE"><span class="icon icon-circle-arrow-left"></span> Previous</a>
        <a href="../6_la_clusula_group_by/" class="btn btn-neutral float-right" title="6. La clàusula GROUP BY">Next <span class="icon icon-circle-arrow-right"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
    
      <span><a href="../4_la_clusula_where/" style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
      <span><a href="../6_la_clusula_group_by/" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script src="../../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "../..";</script>
    <script src="../../js/theme_extra.js"></script>
    <script src="../../js/theme.js"></script>
      <script src="../../search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
